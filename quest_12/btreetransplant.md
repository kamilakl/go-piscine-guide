# Quest 12.11. btreetransplant

## –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ Go

`btreetransplant.go`

---

## –£—Å–ª–æ–≤–∏—è –∑–∞–¥–∞–Ω–∏—è

| **Instruction**                                                                                                               | **–ü–µ—Ä–µ–≤–æ–¥**                                                                                                                               |
| ----------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| *Write a function, BTreeTransplant, which replaces the subtree started by node with the node rplc in the tree given by root.* | *–ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –Ω–∞—á–∏–Ω–∞—é—â–µ–µ—Å—è —Å —É–∑–ª–∞ `node`, –Ω–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –Ω–∞—á–∏–Ω–∞—é—â–µ–µ—Å—è —Å `rplc` –≤ –¥–µ—Ä–µ–≤–µ —Å –∫–æ—Ä–Ω–µ–º `root`.* |

---

–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è **–∑–∞–º–µ–Ω—è–µ—Ç –æ–¥–Ω–æ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –Ω–∞ –¥—Ä—É–≥–æ–µ**.
–≠—Ç–æ –±–∞–∑–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É–∑–ª–æ–≤ –≤ BST (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ —É–¥–∞–ª–µ–Ω–∏—è).

üìå –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è:

* –í –¥–µ—Ä–µ–≤–µ –µ—Å—Ç—å —É–∑–µ–ª `node`.
* –ï–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —É–∑–ª–æ–º `rplc`.
* –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞–¥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å `Parent` —Å—Å—ã–ª–∫–∏.
* –ï—Å–ª–∏ –∑–∞–º–µ–Ω—è–µ–º –∫–æ—Ä–µ–Ω—å ‚Äî –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å `rplc`.

---

### –ü—Ä–∏–º–µ—Ä

–î–µ—Ä–µ–≤–æ –¥–æ –æ–ø–µ—Ä–∞—Ü–∏–∏:

```
        4
      /   \
     1     7
          /
         5
```

–ú—ã –¥–µ–ª–∞–µ–º:

* `node = 1`
* `rplc = 3` (–Ω–æ–≤—ã–π —É–∑–µ–ª)

–ü–æ—Å–ª–µ BTreeTransplant –¥–µ—Ä–µ–≤–æ —Å—Ç–∞–Ω–µ—Ç:

```
        4
      /   \
     3     7
          /
         5
```

–ò inorder-–æ–±—Ö–æ–¥ –≤—ã—Ö–æ–¥–∏—Ç:

```
3
4
5
7
```

---

## –†–µ—à–µ–Ω–∏–µ

```go
package piscine

func BTreeTransplant(root, node, rplc *TreeNode) *TreeNode {
	if node == nil {
		return root
	}

	if node.Parent == nil {
		if rplc != nil {
			rplc.Parent = nil
		}
		return rplc
	}

	if node.Parent.Left == node {
		node.Parent.Left = rplc
	} else {
		node.Parent.Right = rplc
	}

	if rplc != nil {
		rplc.Parent = node.Parent
	}

	return root
}
```

---

## –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è

| **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç / —ç–ª–µ–º–µ–Ω—Ç –∫–æ–¥–∞**              | **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ**                                                 |
| ------------------------------------------ | --------------------------------------------------------------------------- |
| **Transplant (–ø–µ—Ä–µ—Å–∞–¥–∫–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–∞)**       | –ó–∞–º–µ–Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ –¥—Ä—É–≥–∏–º ‚Äî –≤–∞–∂–Ω—ã–π —à–∞–≥ –≤ —É–¥–∞–ª–µ–Ω–∏–∏ —É–∑–ª–æ–≤.               |
| **–£–∑–µ–ª `node`**                            | –ü–æ–¥–¥–µ—Ä–µ–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å.                                          |
| **–£–∑–µ–ª `rplc` (replacement)**              | –ü–æ–¥–¥–µ—Ä–µ–≤–æ, –∫–æ—Ç–æ—Ä—ã–º –∑–∞–º–µ–Ω—è–µ–º `node`. –ú–æ–∂–µ—Ç –±—ã—Ç—å `nil`.                       |
| **Parent-—É–∫–∞–∑–∞—Ç–µ–ª–∏**                       | –í–∞–∂–Ω—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞ ‚Äî –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —É —Ä–æ–¥–∏—Ç–µ–ª—è –∏ —É rplc. |
| **–°–ª—É—á–∞–π —Å –∫–æ—Ä–Ω–µ–º (`node.Parent == nil`)** | –ï—Å–ª–∏ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä–µ–Ω—å, –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å ‚Äî `rplc`.                              |
| **–õ–µ–≤—ã–π –∏–ª–∏ –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫**               | –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `node`: —Å–ª–µ–≤–∞ –∏–ª–∏ —Å–ø—Ä–∞–≤–∞ —É —Ä–æ–¥–∏—Ç–µ–ª—è.         |
| **–í–æ–∑–≤—Ä–∞—Ç –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–Ω—è**                   | –§—É–Ω–∫—Ü–∏—è –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞.                        |

---

## –õ–æ–≥–∏–∫–∞ –∏ –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä –∫–æ–¥–∞

### 1. –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

```go
func BTreeTransplant(root, node, rplc *TreeNode) *TreeNode {
```

–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:

* `root` ‚Äî –∫–æ—Ä–µ–Ω—å –≤—Å–µ–≥–æ –¥–µ—Ä–µ–≤–∞
* `node` ‚Äî —É–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å
* `rplc` ‚Äî —É–∑–µ–ª-–∑–∞–º–µ–Ω–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å `nil`)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

* –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ node = nil ‚Üí –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

```go
if node == nil {
	return root
}
```

–ï—Å–ª–∏ –∑–∞–º–µ–Ω—è—Ç—å –Ω–µ—á–µ–≥–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—Ä–µ–Ω—å.

---

### 3. –°–ª—É—á–∞–π 1: –∑–∞–º–µ–Ω—è–µ–º **–∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞**

```go
if node.Parent == nil {
	if rplc != nil {
		rplc.Parent = nil
	}
	return rplc
}
```

–ï—Å–ª–∏ —É `node` –Ω–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è ‚Äî —ç—Ç–æ –∫–æ—Ä–µ–Ω—å.

–ß—Ç–æ –¥–µ–ª–∞–µ–º:

* –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `rplc`
* —É `rplc` —Ä–æ–¥–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `nil`
* –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `rplc`

---

### 4. –°–ª—É—á–∞–π 2: node –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–ª–µ–≤–∞ –∏–ª–∏ —Å–ø—Ä–∞–≤–∞ —É —Ä–æ–¥–∏—Ç–µ–ª—è

```go
if node.Parent.Left == node {
	node.Parent.Left = rplc
} else {
	node.Parent.Right = rplc
}
```

–°–º–æ—Ç—Ä–∏–º:

* –µ—Å–ª–∏ `node` –±—ã–ª –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º ‚Üí –∑–∞–º–µ–Ω—è–µ–º –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –Ω–∞ `rplc`
* –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω—è–µ–º –ø—Ä–∞–≤–æ–≥–æ

–≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–≤—è–∑—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É —É —Ä–æ–¥–∏—Ç–µ–ª—è.

---

### 5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è replacement-—É–∑–ª—É

```go
if rplc != nil {
	rplc.Parent = node.Parent
}
```

–ï—Å–ª–∏ `rplc` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –≤–∞–∂–Ω–æ:

* —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ `Parent`
* —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π —à–∞–≥, —á—Ç–æ–±—ã –¥–µ—Ä–µ–≤–æ –Ω–µ "—Å–ª–æ–º–∞–ª–æ—Å—å"

---

### 6. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—Ä–µ–Ω—å (–µ—Å–ª–∏ –æ–Ω –Ω–µ –º–µ–Ω—è–ª—Å—è)

```go
return root
```

–ï—Å–ª–∏ –Ω–µ –∑–∞–º–µ–Ω—è–ª–∏ –∫–æ—Ä–µ–Ω—å, —Å—Ç–∞—Ä—ã–π –∫–æ—Ä–µ–Ω—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ

–î–∞–Ω–æ –¥–µ—Ä–µ–≤–æ:

```
        4
      /   \
     1     7
          /
         5
```

–ò –≤—ã–ø–æ–ª–Ω—è–µ–º:

```
node = 1
rplc = 3
```

–®–∞–≥–∏:

1. node.Parent != nil (—É 1 —Ä–æ–¥–∏—Ç–µ–ª—å ‚Äî 4)
2. node ‚Äî –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ 4 ‚Üí –∑–∞–º–µ–Ω—è–µ–º 4.Left = 3
3. rplc.Parent = 4
4. root –Ω–µ –º–µ–Ω—è–ª—Å—è ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞—Ä—ã–π root

–ù–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ:

```
        4
      /   \
     3     7
          /
         5
```

---

## –ì–ª–æ—Å—Å–∞—Ä–∏–π

| **–¢–µ—Ä–º–∏–Ω**        | **–ü–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ**                     |
| ----------------- | ------------------------------------------- |
| **Transplant**    | –û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–º–µ–Ω—ã –æ–¥–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ –Ω–∞ –¥—Ä—É–≥–æ–µ. |
| **node**          | –£–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–µ—Ç—Å—è –∏–ª–∏ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è.     |
| **rplc**          | –£–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–æ `node`.  |
| **Parent**        | –†–æ–¥–∏—Ç–µ–ª—å —É–∑–ª–∞. –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–≤–µ—Ä—Ö –ø–æ –¥–µ—Ä–µ–≤—É.  |
| **Left / Right**  | –î–µ—Ç–∏ —É–∑–ª–∞. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ BST –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –Ω–∏—Ö.   |
| **–ö–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞** | –£–∑–µ–ª –±–µ–∑ —Ä–æ–¥–∏—Ç–µ–ª—è. –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–µ—Ä–µ–≤–∞.  |
| **nil**           | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —É–∑–µ–ª.                         |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å:

* `BTreeTransplant` ‚Äî –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π **—É–¥–∞–ª–µ–Ω–∏—è** –≤ BST.
* –û–Ω–∞ –∑–∞–º–µ–Ω—è–µ—Ç `node` –Ω–∞ `rplc`, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–≤—è–∑—ã–≤–∞—è —Å—Å—ã–ª–∫–∏.
* –í–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å:

  * —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è **–∫–æ—Ä–µ–Ω—å**
  * –∑–∞–º–µ–Ω—É —É –ª–µ–≤–æ–≥–æ –∏–ª–∏ –ø—Ä–∞–≤–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è
  * –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `Parent` –¥–ª—è `rplc`
* –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –º–µ–Ω—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–∑–ª–æ–≤ ‚Äî —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –Ω–∏–º–∏.
